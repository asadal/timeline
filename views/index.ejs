<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title><%= settings.site_title %></title>
    <!-- Gmarket Sans 폰트 로드 -->
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/ungveloper/web-fonts/GmarketSans/font-face.css" />
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/ungveloper/web-fonts/GmarketSans/font-family.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Gmarket Sans 폰트 적용 */
        .font-gmarket {
            font-family: 'GmarketSans', sans-serif;
        }

        /* Noto Sans KR 폰트 적용 */
        .font-noto {
            font-family: 'Noto Sans KR', sans-serif;
        }

        /* 상단 고정 제목 바 스타일 */
        .sticky-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background-color: rgba(255, 255, 255, 0.7); /* 70% 투명도 */
            backdrop-filter: blur(10px); /* 배경 흐림 효과 */
            z-index: 1000; /* sticky header가 다른 요소 위에 표시되도록 */
            display: none; /* 기본적으로 숨김 */
            justify-content: center;
            align-items: center;
            height: 50px;
            padding: 0.5rem 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* 그림자 효과 */
        }

        .sticky-header.visible {
            display: flex; /* 스크롤 시 나타나도록 설정 */
        }

        /* 페이지 내용 스타일 */
        .page-content {
            margin-top: 80px; /* 상단 고정 바를 가리지 않도록 공간 확보 */
        }

        /* 설명 박스 숨김 상태 */
        .hidden-description {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        /* 설명 박스 표시 상태 */
        .visible-description {
            max-height: 500px; /* 충분히 큰 값으로 설정 */
            overflow: hidden;
            transition: max-height 0.3s ease-in;
        }

        /* Top 버튼, Bottom 버튼 스타일 */
        .scroll-button {
            position: fixed;
            right: 20px;
            padding: 10px 20px;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            transition: background-color 0.3s;
        }

        .scroll-button:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }

        /* Top 버튼 위치 */
        .top-button {
            bottom: 70px; /* Top 버튼은 아래쪽으로 내려서 배치 */
        }

        /* Bottom 버튼 위치 */
        .bottom-button {
            bottom: 20px; /* Bottom 버튼은 위에서 50px 더 내려서 배치 */
        }

        /* 웹사이트 설명 텍스트 양쪽 정렬 */
        .site-description {
            text-align: justify;
        }

        /* 웹사이트 설명 박스 고정 가로폭 800px */
        .description-box {
            width: 800px; /* 800px 고정 */
            margin: 0 auto; /* 가운데 정렬 */
        }
        
        /* 타임라인 항목 제목 폰트 크기 30px */
        .timeline-title {
            font-size: 30px; /* 제목 크기 30px로 수정 */
        }
    </style>
</head>
<body class="bg-white transition-colors duration-300">

    <!-- 상단 고정 제목 바 -->
    <div id="sticky-header" class="sticky-header">
        <a href="javascript:void(0);" class="text-xl font-bold text-gray-900 font-gmarket hover:underline" id="sticky-header-link">
            <%= settings.site_title %>
        </a>
    </div>
    
    <!-- 웹사이트 제목 및 설명 -->
    <div id="top" class="max-w-[800px] mx-auto px-4 mt-12">
        <div class="text-center mb-4">
            <!-- Gmarket Sans 폰트가 적용된 제목 -->
            <h1 class="text-6xl font-extrabold text-gray-900 md:text-5xl font-gmarket">
                <%= settings.site_title %>
            </h1>
            <!-- 설명 부분 -->
            <div class="mt-8 mb-8 flex flex-col items-center justify-center">
                <div id="description-box" class="description-box border p-4 bg-gray-50 rounded-md">
                    <span id="site-description" class="block text-lg text-gray-600 font-noto md:text-base visible-description site-description">
                        <%- settings.site_description %> <!-- 줄바꿈이 <br>으로 적용됨 -->
                    </span>
                </div>
                <!-- 화살표 버튼 -->
                <button id="toggle-description" class="toggle-button text-gray-600 mt-2 focus:outline-none">
                    ︿
                </button>
            </div>
        </div>

        <!-- 타임라인 목록 -->
        <div class="page-content">
            <ol class="relative border-l border-gray-200">
                <% timeline.forEach(function(item) { %>
                    <li class="mb-10 ml-6">
                        <div class="absolute w-3 h-3 bg-gray-200 rounded-full mt-1.5 -left-1.5 border border-white"></div>
                        <time class="mb-1 text-sm font-normal leading-none text-gray-400 font-noto">
                            <% if (item.show_time) { %>
                                <%= item.formattedDate %> <%= item.formattedTime %>
                            <% } else { %>
                                <%= item.formattedDate %>
                            <% } %>
                        </time>
                        <h3 class="text-2xl font-semibold text-gray-900 font-gmarket timeline-title"><%= item.title %></h3>
                        <p class="mb-4 text-lg font-normal text-gray-500 font-noto"><%= item.body %></p>
                        <% if (item.image) { %>
                            <% if (item.image.includes('youtube.com') || item.image.includes('youtu.be')) { %>
                                <!-- 유튜브 동영상 URL이면 iframe으로 임베딩 -->
                                <iframe width="560" height="315" src="https://www.youtube.com/embed/<%= item.image.split('v=')[1] %>" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="mb-4 w-full max-w-[500px]"></iframe>
                            <% } else { %>
                                <!-- 일반 이미지 처리 -->
                                <img src="<%= item.image %>" alt="타임라인 이미지" class="mb-4 w-full max-w-[500px]">
                            <% } %>
                        <% } %>

                        <% if (item.link) { %>
                            <a href="<%= item.link %>" target="_blank" class="inline-flex items-center px-4 py-2 text-teal-600 border border-teal-600 rounded-md text-sm font-medium hover:bg-teal-600 hover:text-white focus:ring-2 focus:ring-teal-600 focus:outline-none transition-colors duration-200 font-noto">
                            더 알아보기
                            <svg class="w-3 h-3 ml-2 transform transition-transform duration-300" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10">
                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 5h12m0 0L9 1m4 4L9 9"/>
                            </svg>
                        </a>
                        <% } %>
                    </li>
                <% }); %>
            </ol>
        </div>
    </div>

    <!-- 'Top' 버튼 -->
    <button id="top-button" class="scroll-button top-button" onclick="window.scrollTo(0, 0)">
        ∧
    </button>

    <!-- 'Bottom' 버튼 -->
    <button id="bottom-button" class="scroll-button bottom-button" onclick="window.scrollTo(0, document.body.scrollHeight)">
        ∨
    </button>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // 설명 박스 접기/펼치기
            const toggleButton = document.getElementById('toggle-description');
            const siteDescription = document.getElementById('site-description');

            toggleButton.textContent = '︿'; // 초기 버튼 텍스트 설정

            toggleButton.addEventListener('click', function () {
                if (siteDescription.classList.contains('visible-description')) {
                    siteDescription.classList.remove('visible-description');
                    siteDescription.classList.add('hidden-description');
                    toggleButton.textContent = '﹀';
                } else {
                    siteDescription.classList.remove('hidden-description');
                    siteDescription.classList.add('visible-description');
                    toggleButton.textContent = '︿';
                }
            });

            // 스크롤 시 제목 고정 기능
            const stickyHeader = document.getElementById('sticky-header');
            const mainTitle = document.querySelector('h1');

            window.addEventListener('scroll', function () {
                const titleBottom = mainTitle.getBoundingClientRect().bottom;

                if (titleBottom <= 0) {
                    stickyHeader.classList.add('visible');
                } else {
                    stickyHeader.classList.remove('visible');
                }
            });

            // 상단 제목 클릭 시 페이지 상단으로 스크롤
            const stickyHeaderTitle = document.getElementById('sticky-header');
            stickyHeaderTitle.addEventListener('click', function () {
                window.scrollTo(0, 0);
            });
        });
    </script>

</body>
</html>

